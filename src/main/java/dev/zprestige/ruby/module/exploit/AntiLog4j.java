package dev.zprestige.ruby.module.exploit;

import dev.zprestige.ruby.eventbus.annotation.RegisterListener;
import dev.zprestige.ruby.events.PacketEvent;
import dev.zprestige.ruby.module.Category;
import dev.zprestige.ruby.module.Module;
import dev.zprestige.ruby.module.ModuleInfo;
import net.minecraft.network.play.server.SPacketChat;

@ModuleInfo(name = "AntiLog4j", category = Category.Exploit, description = "Prevents log4j exploite")
public class AntiLog4j extends Module {

    @RegisterListener
    public void onPacketReceive(PacketEvent.PacketReceiveEvent event) {
        if (nullCheck() || !isEnabled() || !(event.getPacket() instanceof SPacketChat))
            return;
        String chatMessage = ((SPacketChat) event.getPacket()).getChatComponent().getUnformattedText().toLowerCase();
        event.setCancelled(chatMessage.contains("{") || chatMessage.contains("}") || chatMessage.contains("log4j") || chatMessage.contains("jndi:ldap"));
    }
}
